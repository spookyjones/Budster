<% @user.posts.reverse.each do |post| %>
	<table class="posts">
		<tr class="<%= cycle('even', 'odd') %>">
			<td class="content" rowspan="2" width="100px">
				<%= link_to image_tag(@user.normalimage), @user %>
			</td>
			<td colspan="5" class="content">
				<% unless post.image.url == "/images/original/missing.png" %>
					<%= image_tag post.image.url(:large) %><br>
				<% end %>
				<%= post.content %>
			</td>
		</tr>
		<tr class="<%= cycle('even', 'odd') %>">
			<% if post.price %>
				<td class="info">
					$<%= post.price ? post.price.cost : ""  %>
				</td>
			<% end %>
			<% if post.strain %>
				<% if post.strain.name.parameterize == "unknown" %>
					<td class="info">
						<%= link_to post.strain.name.titleize, graphs_path %>
					</td>
				<% else %>
					<td class="info">
						<%= link_to post.strain.name.titleize, show_path( :s_slug => post.strain.name.parameterize ) %>
					</td>
				<% end %>
			<% end %>
			<% unless post.region.name.blank? == true %>
				<td class="info"><%= post.region %></td>
			<% end %>
			<td class="info" id="button"><%= time_ago_in_words(post.created_at) %> ago
			<% if @user == current_user %>
					<%= link_to 'Delete', {:controller=>:posts, :action=>:destroy, :id=>post.id}, :method=>:delete, :class=>"button" %>
				</td>
			<% else %>
				<% unless post.liked_by?(current_user) %>
					<td class="info">
						<%= link_to 'Like', post_like_path(:post_id=>post.id), method: :post, :class=>"button" %>
					</td>
				<% else %>
					<td class="info">
						<%= link_to 'Unlike', post_unlike_path(:post_id=>post.id), method: :post, :class=>"button" %>
					</td>
				<% end %>
			<% end %>
		</tr>
	</table>
	<table class="posts">
		<% post.comments.each do |c| %>
			<tr class="<%= cycle('even', 'odd') %>">
				<td class="content" width="50px" rowspan="2">
					<%= link_to image_tag(c.user.smallimage), c.user %>
				</td>
				<td colspan="3" class="content">
					<%= image_tag c.image.url(:large) %><br>
					<%= c.content %>
				</td>
			</tr>
			<tr class="<%= cycle('even', 'odd') %>">
				<td class="info" colspan="2" >
					<%= time_ago_in_words(post.created_at) %> ago 
					<% if c.user == current_user %>
						<%= link_to 'Delete', {:controller=>:comments, :action=>:destroy, :id=>c.id}, :method=>:delete, :class=>"button"%>
					<% else %>
						<% unless c.liked_by?(current_user) %>
								<%= link_to 'Like', comment_like_path(:comment_id=>c.id), method: :post, :class=>"button" %>
						<% else %>
								<%= link_to 'Unlike', comment_unlike_path(:comment_id=>c.id), method: :post, :class=>"button" %>
						<% end %>
					<% end %>
				</td>
			</tr>
			<% c.replies.each do |reply| %>
				<tr class="<%= cycle('even', 'odd') %>">
					<td rowspan="2">	
					</td>
					<td class="content" width="50px" rowspan="2">
						<%= link_to image_tag(reply.user.smallimage), reply.user %>
					</td>
					<td colspan="3" class="content" id="reply">
						<%= image_tag reply.image.url(:large) %><br>
						<%= reply.content %>
					</td>
					</tr>
						<tr class="<%= cycle('even', 'odd') %>">
							<td colspan="2" class="info" id="button">
								<%= time_ago_in_words(post.created_at) %> ago
						<% if reply.user == current_user %>
								<%= link_to 'Delete', {:controller=>:replies, :action=>:destroy, :id=>reply.id}, :method=>:delete, :class=>"button"%>
						<% else %>
							<% unless reply.liked_by?(current_user) %>
									<%= link_to 'Like', reply_like_path(:reply_id=>reply.id), method: :post, :class=>"button" %>
							<% else %>
									<%= link_to 'Unlike', reply_unlike_path(:reply_id=>reply.id), method: :post, :class=>"button" %>
							<% end %>
						<% end %>
					</td>
				</tr>
			<% end%>
			<tr class="<%= cycle('even', 'odd') %>">
				<td colspan="14">
					<%= form_for(@reply, :url => reply_create_path, :html => { :multipart => true }) do |r| %>
						<%= r.text_field :content, :placeholder => "Reply" %>
						<%= r.hidden_field :user_id, :value => current_user.id %>
						<%= r.hidden_field :comment_id, :value => c.id %>
						<% r.label :image %>
						<%= r.file_field :image %>
						<%= r.submit %>
					<% end %>
				</td>
			</tr>
		<% end %>	
	</table>
	<table> 
		<tr>
			<td>
				<% if user_signed_in? %> 
					<%= form_for(@comment, :url => comment_create_path, :html => { :multipart => true }) do |comment| %>
						<%= comment.hidden_field :user_id, :value => current_user.id %>
						<%= comment.hidden_field :post_id, :value => post.id %>
						<%= comment.text_field :content, :placeholder => 'Leave a comment', class: 'users' %>
						<%= comment.file_field :image %>
						<%= comment.submit "Comment" %>
					<% end %>
				<% end %>
			</td>
		</tr>
	</table>
	<br>
<% end %>
